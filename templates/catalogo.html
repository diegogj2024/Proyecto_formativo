<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo - Creaciones Esmir</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/estilos_catalogo.css') }}">
</head>
<body>
    <header>
        <div class="contenedor_logo">
            <div class="logo">
                <img src="https://sdmntprnorthcentralus.oaiusercontent.com/files/00000000-ccb4-622f-b93c-0fe8013ce9b2/raw?se=2025-05-08T13%3A52%3A24Z&sp=r&sv=2024-08-04&sr=b&scid=00000000-0000-0000-0000-000000000000&skoid=bbd22fc4-f881-4ea4-b2f3-c12033cf6a8b&sktid=a48cca56-e6da-484e-a814-9c849652bcb3&skt=2025-05-08T00%3A28%3A48Z&ske=2025-05-09T00%3A28%3A48Z&sks=b&skv=2024-08-04&sig=D%2Bg70KsJ8StIkJV79cLKbk6Ej4JG9oZh3P%2BoVaGfFP8%3D" alt="Logo Creaciones Esmir">
            </div>
            <span class="logo-texto">Creaciones Esmir</span>
        </div>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for mensaje in messages %}
                    <div class="alert">{{ mensaje }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        <nav>
            <a href="#">Buscar</a>
            <a href="#">Mi Carrito</a>
            <a href="" id="loginLink">Iniciar Sesión</a>
            <a href="#" id="registerLink">Registrarse</a>
            </nav>
    </header>

    <div class="container">
        <h2>Colección Destacada</h2>

        <div class="product-grid" id="productGrid">
            {% for pro in productos %}
                <div class="product-card">
                    <img src="{{ url_for('static', filename='productos/' + pro.imagen) }}" alt="{{pro.nombre_producto}}">
                    <h3>{{pro.nombre_producto}}</h3>
                    <p class="description">{{pro.descripcion}}</p>
                    <p class="price">${{pro.precio}}</p>
                    <div class="tallas">
                        <strong>Tallas disponibles:</strong>
                    <form action="/guardar_en_carrito" method="POST">
                            <ul>
                                {% for id_talla, datos in tallas_por_producto[pro.id_producto].items() %}
                                    <input type="radio" class="talla-checkbox" name="talla" value="{{ id_talla }}" data-talla="{{ datos.nombre_talla }}" checked>
                                    {{ datos.nombre_talla }} - Cantidad: {{ datos.cantidad }} - ingresa la cantidad que desas comprar <input type="number" name="cantidad" min="1" max="{{ datos.cantidad }}"><br>
                                {% endfor %}

                            </ul>
                    </div>
                    <button data-product-id="{{pro.id_producto}}" name="id_p" value="{{pro.id_producto}}">Añadir al Carrito</button>
                    </form>
                </div>
            {% endfor %}
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Creaciones Esmir. Todos los derechos reservados.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const productGrid = document.getElementById('productGrid');
            const loginLink = document.getElementById('loginLink');
            const registerLink = document.getElementById('registerLink');

            if (productGrid) {
                productGrid.addEventListener('click', (event) => {
                    if (event.target.tagName === 'BUTTON' && event.target.hasAttribute('data-product-id')) {
                        const productId = event.target.getAttribute('data-product-id');
                        const productName = event.target.closest('.product-card').querySelector('h3').textContent;
                        console.log(`Producto "${productName}" (ID: ${productId}) añadido al carrito.`);
                        alert(`¡"${productName}" añadido al carrito!`);
                    }
                });
            }

            if (loginLink) {
                loginLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.location.href = '/inicio_sesion';
                });
            }

            if (registerLink) {
                registerLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.location.href = '/inicio_sesion'; 
                });
            }
        });
    </script>
</body>
</html>